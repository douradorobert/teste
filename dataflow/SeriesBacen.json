{
	"name": "SeriesBacen",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "cotacoes",
						"type": "DatasetReference"
					},
					"name": "cotacoes"
				},
				{
					"dataset": {
						"referenceName": "dicionario_cotacao",
						"type": "DatasetReference"
					},
					"name": "dicionario"
				}
			],
			"sinks": [
				{
					"name": "seriesbacen"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "join"
				},
				{
					"name": "Selecionar1"
				},
				{
					"name": "Select1"
				}
			],
			"script": "source(output(\n\t\tdia as string,\n\t\tcodigo as string,\n\t\ttipo as string,\n\t\tmoeda as string,\n\t\tcompra_real as string,\n\t\tvenda_real as string,\n\t\tcompra_dolar as string,\n\t\tvenda_dolar as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> cotacoes\nsource(output(\n\t\tmoeda as string,\n\t\talias0_sellpricedollar as string,\n\t\talias1_sellpricedollar as string,\n\t\talias0_sellprice as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> dicionario\nSelecionar1 derive(alias0_sellpricedollar = iif(!isNull(alias0_sellpricedollar),\r\n    concat(\"<SERIE code=\\\"\", alias0_sellpricedollar,\"\\\" value=\\\"\", sellpricedollar,\"\\\"/>\"),\r\n    alias0_sellpricedollar),\n\t\talias1_sellpricedollar = iif(!isNull(alias1_sellpricedollar),\r\n    concat(\"<SERIE code=\\\"\", alias1_sellpricedollar,\"\\\" value=\\\"\", sellpricedollar,\"\\\"/>\"),\r\n    alias1_sellpricedollar),\n\t\talias0_sellprice = iif(!isNull(alias0_sellprice),\r\n    concat(\"<SERIE code=\\\"\", alias0_sellprice,\"\\\" value=\\\"\", sellprice,\"\\\"/>\"),\r\n    alias0_sellprice)) ~> DerivedColumn1\ncotacoes, dicionario join(cotacoes@moeda == dicionario@moeda,\n\tjoinType:'right',\n\tbroadcast: 'auto')~> join\njoin select(mapColumn(\n\t\tmoeda = cotacoes@moeda,\n\t\tbuyprice = compra_real,\n\t\tsellprice = venda_real,\n\t\tbuypricedollar = compra_dolar,\n\t\tsellpricedollar = venda_dolar,\n\t\tmoeda = dicionario@moeda,\n\t\talias0_sellpricedollar,\n\t\talias1_sellpricedollar,\n\t\talias0_sellprice\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Selecionar1\nDerivedColumn1 select(mapColumn(\n\t\talias0_sellpricedollar,\n\t\talias1_sellpricedollar,\n\t\talias0_sellprice\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 sink(skipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> seriesbacen"
		}
	}
}